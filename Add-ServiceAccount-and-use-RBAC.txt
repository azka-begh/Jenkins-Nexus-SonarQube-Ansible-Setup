kubectl create serviceaccount jenkins
kubectl get serviceaccounts jenkins -o yaml
TOKEN=$(kubectl create token jenkins)
kubectl config set-credentials jenkins --token=$TOKEN

kubectl config current-context

kubectl create role serviceaccountrole --verb=create,list,get --resource=pods,pods/log --namespace=default --dry-run=client -o yaml > role.yml 
kubectl create rolebinding servicerolebind --role=serviceaccountrole --serviceaccount=default:jenkins --dry-run=client -o yaml > rolebind.yml 
kubectl apply -f role.yml 
kubectl apply -f rolebind.yml 

kubectl config set-context jenkins-context --cluster=k8skops.aab12.xyz --user=jenkins
kubectl config get-contexts

kubectl auth can-i create deployments --namespace=default --as=jenkins
kubectl auth can-i create secrets --namespace=default --as=jenkins
kubectl auth can-i get pods --namespace=default --as=jenkins

kubectl config use-context jenkins-context
kubectl get pods
